<html>
<head>
<title>Snake</title>
<script language="JavaScript">

class Canvas {
    constructor(canvasNode, scale){
        this._canvasNode = canvasNode;
        this._scale = scale;
    }
    
    clear(){
        let context = this._getContext();
        context.clearRect(0, 0, this._canvasNode.width, this._canvasNode.height);
    }
    
    drawPoint(point, color){
        let context = this._getContext();
        context.fillStyle = color;
        let maxY = this._canvasNode.height/this._scale - 1;
        let x = this._scale * point.x;
        let y = this._scale * (maxY - point.y);
        
        context.fillRect(x, y, this._scale, this._scale);
    }
    
    _getContext(){
        return this._canvasNode.getContext("2d");
    }

}

function drawNow(){
    let canvasNode = document.getElementById("myCanvas");
    
    let canvas = new Canvas(canvasNode, 10);
    canvas.clear();
    
    let points = window.getPositionForSnake();
  
    for (let i = 0; i<points.length; i++){
      canvas.drawPoint(points[i],"#000000");
      
    }

}

// Send a query to the browser process.
function sendMessage() {
  // Results in a call to the OnQuery method in client_impl.cc.
  window.cefQuery({
    request: 'getSnakePosition:' + document.getElementById("message").value,
    onSuccess: function(response) {
      document.getElementById('result').value = 'Response: '+response;
    },
    onFailure: function(error_code, error_message) {}
  });
}
</script>

</head>
<body bgcolor="white">

<canvas id="myCanvas" width="500" height="500" style="border:1px solid #d3d3d3;">

</body>
</html>
